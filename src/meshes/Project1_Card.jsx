

/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
*/

import * as THREE from 'three'
import React, { useRef, useState } from 'react'
import { useGLTF, useAnimations, Html } from '@react-three/drei'
import { useSpring, useChain, useSpringRef, animated } from '@react-spring/three'
import Project_Details from '../faces/Project_Details'
import Project_Card_Face from '../faces/Project_Card_Face'
import { FaceData, DetailsData, ProjMedia } from '../faces/Project1_Data'

export default function Project1_Card({ isOpened, onProj1Clicked, Proj1Clicked, ...props }) {
  const group = useRef()
  const { nodes, materials, animations } = useGLTF('/final_models/Proj1final.glb')

  const [secTime, toggleSecTime] = useState();

  const positionSpringRef = useSpringRef();
  const rotationSpringRef = useSpringRef();

  const positionSpring = useSpring({
    ref: positionSpringRef,
    pos: Proj1Clicked ? [20, -0.3, -0.93] : [-0.01, 0, -0.758],
    config: Proj1Clicked ? { mass: 1, tension: 60, friction: 8 } : { mass: 1, tension: 50, friction: 20 },
  });

  const rotationSpring = useSpring({
    ref: rotationSpringRef,
    rot: Proj1Clicked ? [0, THREE.MathUtils.degToRad(900), 0] : [0, 0, 0],
  });

  useChain(Proj1Clicked ? [positionSpringRef, rotationSpringRef] : [rotationSpringRef, positionSpringRef], [0, secTime]);

  const helper = () => {
    if(isOpened) {
      console.log('clicked 5');
      if (Proj1Clicked) {              //time for pos to play after rot
        toggleSecTime(0.4);
      } else {                         //time for rot to play after pos
        toggleSecTime(0.9);
      }
      onProj1Clicked();
    }
  };
  return (
    <group ref={group} {...props} dispose={null}>
      <group name="Scene" onClick={helper}>
        <animated.group name="ArmatureSleeve" position={positionSpring.pos} rotation={rotationSpring.rot}>
          <skinnedMesh
            name="Proj1Card"
            geometry={nodes.Proj1Card.geometry}
            material={materials.Project_Material}
            skeleton={nodes.Proj1Card.skeleton}
          />
          <primitive object={nodes.firstfold} />
          <primitive object={nodes.firstsleeve}>
            <Html
              occlude="blending"
              wrapperClass="nodes"
              position={[-4.1, 2.67, 0.26]}
              transform
              distanceFactor={8.2}
              rotation-y={THREE.MathUtils.degToRad(1.03)}
              style={{ pointerEvents: 'none' }}
            >
              <Project_Card_Face data={FaceData} ProjMedia={ProjMedia} />
            </Html>
            <Html
              occlude="blending"
              wrapperClass="nodes"
              position={[-4.1, 2.67, 0.1]}
              transform
              distanceFactor={8.2}
              rotation-y={THREE.MathUtils.degToRad(181.03)}
              style={{ pointerEvents: 'none' }}
            >
              <Project_Details />
            </Html>
          </primitive>
        </animated.group>
      </group>
    </group>
  )
}

useGLTF.preload('/final_models/Proj1final.glb')